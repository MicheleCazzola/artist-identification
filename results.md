# Training results

## Model resource consumption

| Backbone Model | HOG | Latency (ms) | FPS | Parameters (M) | Accuracy (%) (*) |
|:-------:|:---------:|:---:|:-----:|:------------:|:---:|
| Random crop | No | 10.4 | 96 | 27.4 | 0.1 (**)  |
| Random crop | 81 | 15.7 | 64 | 27.4 | 0.1 (**) |
| Random crop | 4056 | 18.9 | 53 | 28.05 | 0.1 (**) |
| ResNet18 | No | 19.5 | 51 | 48.75 |69.8 |
| ResNet18 | 81 | 24.7 | 40.4 | 48.77 |69.8 |
| ResNet18 | 4056 | 27.2 | 36.7 | 49.38 |69.8 |
| MobileNetV3-S | No | 21 | 47 | 30.3 |67.7 |
| MobileNetV3-S | 81 | 27.8 | 36 | 30.3 |67.7 |
| MobileNetV3-S | 4056 | 30 | 33.4 | 31 |67.7 |
| EfficientNet-B0 | No | 27.5 | 36.5 | 35.1 |76.3 |
| EfficientNet-B0 | 81 | 33.8 | 29.6 | 35.1 |76.3 |
| EfficientNet-B0 | 4056 | 36.4 | 27.5 |35.7 |76.3 |
| RegNetX-400MF | No | 30 | 33.4 | 37.15 |77.6 |
| RegNetX-400MF | 81 | 36.5 | 27.4 | 37.16 |77.6 |
| RegNetX-400MF | 4056 | 39 | 25.6 | 37.78 |77.6 |
| ShuffleNetV2-X0.5 | No | 23.7 | 42.5 | 28.1 |60.3 |
| ShuffleNetV2-X0.5 | 81 | 30.5 | 33 | 28.1 |60.3 |
| ShuffleNetV2-X0.5 | 4056 | 33.8 | 29.6 | 28.7 |60.3 |
| MNasNet-X0.5 | No | 20.7 | 48.3 | 29.2 |68.9 |
| MNasNet-X0.5 | 81 | 26.5 | 37.7 | 29.2 |68.9 |
| MNasNet-X0.5 | 4056 | 29 | 34.5 | 29.9 |68.9 |


(*) Top-1 accuracy of the backbone model alone, as measured on ImageNet  
(**) Intended as the top-1 accuracy of a random guesser, as measured on ImageNet (1000 classes)

## Trial results

**Notes**:
- metrics are computed on a test set by default, otherwise look for (*)
- HOG features are extracted from a 224x224 center-cropped image, obtained from a 256x256 downsampled image (original is 512x512)

### Dataset 60-20-20

| Backbone Model | HOG | Batch size | Loss | Optimizer |Learning rate | Scheduler step | Scheduler factor | Weight decay | Color jitter (**) | Lighting noise (**) | Gaussian blur (**) | Geometric transform (**) | Epochs | Reduction factor | Best validation loss| Best validation WT5-MCA  (%) | Best epochs | Test loss | Top-1 accuracy (%) | Top-5 accuracy (%) | MCA (%) | Top-5 weighted MCA (%) | Training time (mins) (***) | Output folder |
|:--------------:|:---:|:--:|:----------:|:-----------:|:--:|:-------------:|:------------:|:--:|:------------:|:------:|:----------------:|:--------------:|:--------------:|:---:|:-------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Random crop | No | 32 |  | Adam |  |  |  |  | | | | | |  | |  |  |  |  | | | | |[link]() |
| Random crop | No | 32 | CE | Adam | 1e-3 | - | - | 1e-6 | - | - | - | - | 2 | 1 | 4.3 | 5.1 | 2 | 4.3 | 10.4 | 26.6 | 2.7 | 5.3 | ~20 |[20241229_184457](./out/official/20241229_184457/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 2 | 1 | 3.92 | 10.7 | 2 | 3.9 | 16.2 | 35.4 | 6.65 | 11.1 | ~21 |[20241230_175101](./out/official/20241230_175101/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 2 | 1 | 3.84 | 12 | 2 | 3.8 | 18.4 | 37.4 | 7.4 | 12.3 | ~21 |[20241229_184711](./out/official/20241229_184711/) |
| Random crop | No | 32 | WCE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 2 | 1 | 3.98 | 10.2 | 2 | 3.98 | 13.6 | 30.8 | 6.4 | 10.4 | ~19 |[20241230_000332](./out/official/20241230_000332/) |
| Random crop | No | 32 | WCE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 2 | 1 | 3.79 | 11.2 | 2 | 3.8 | 14 | 30.3 | 7.04 | 11.1 | ~20 |[20241230_185001](./out/official/20241230_185001/) |
| Random crop | No | 32 | WCE | Adam | 1e-4 | - | - | 1e-5 | - | - | - | - | 2 | 1 | 3.81 | 10.7 | 2 | 3.81 | 13.6 | 30.7 | 6.76 | 11 | ~20 |[20241230_192513](./out/official/20241230_192513/) |
| Random crop | No | 32 | WCE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 2 | 1 | 3.6 | 8.05 | 2 | 3.9 | 13.8 | 29.8 | 4.77 | 8.13 | ~21 |[20241230_003603](./out/official/20241230_003603/) |
| Random crop | No | 32 | CE | Adam | 1e-3 | - | - | 1e-6 | - | - | - | - | 6 | 1 | 3.8 | 14.6 | 6 | 3.8 | 18.19 | 39.51 | 9.8 | 15.31 | 60 |[overfitting peppe](./out/official/20250102_112519/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-3 | - | - | - | - | 6 | 1 | 3.38 | 21.7 | 6 | 3.4 | 25 | 47.69 | 14.35 | 21.50 | 60 |[20250102_124228](./out/official/20250102_124228/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 6 | 1 | 3.44 | 21.1 | 6 | 3.4 | 25 | 48.5 | 14.9 | 22.4 | 60 |[20241230_225438](./out/official/20241230_225438/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | 5 (single) | 0.1 | 1e-6 | - | - | - | - | 11 | 1 | 3.1 | 27.25 | 11 | 3.09 | 31.2 | 54.6 | 19.4 | 27.4 | 120 |[20250101_130341](./out/official/20250101_130341/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 11 | 1 | 3.02 | 30.3 | 11 | 3.03 | 31.6 | 56.7 | 21 | 29.9 | 110 |[20250102_175318](/out/official/20250102_175318/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 21 | 1 | 2.84 | 37.8 | 21 | 2.9 | 36.9 | 61.7 | 27 | 35.9 | 210 |[20250102_222514](/out/official/20250102_222514/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-5 | - | - | - | - | 21 | 1 | 2.79 | 38.7 | 21 | 2.84 | 37.9 | 61.8 | 28.8 | 37.6 | 210 |[20250103_141138](/out/official/20250103_141138/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-4 | - | - | - | - | 21 | 1 | 2.82 | 37.4 | 21 | 2.87 | 36.9 | 61.6 | 27.5 | 36.5 | 211 |[20250103_184412](/out/official/20250103_184412/) |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-6 | - | - | - | - | 5 | 1 | 3.30 | 21.86 | 5 | 3.36 | 24.5 | 48.2 | 13.9 | 21.2 | 52 |[05/01](/out/official/20250105_200736/) |
| Random crop | No | 32 | CE | AdamW | 1e-3 | - | - | 1e-5 | - | - | - | - | 5 | 1 | 3.86 | 12.46 | 5 | 3.88 | 16.4 | 35.6 | 7.24 | 12.4 | 53 |[05/01](/out/official/20250105_214543/) |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 5 | 1 | 3.33 | 23.5 | 5 | 3.38 | 24.5 | 48.1 | 15.1 | 22.5 | 52 |[05/01](/out/official/20250105_214716/) |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 10 | 1 | 2.935 | 31.2 | 10 | 2.98 | 31.6 | 56.3 | 20.7 | 29.7 | 104 |[05/01](/out/official/20250105_234725/) |
| Random crop | No | 32 | WCE | Adam | 1e-4 | - | - | 1e-6 | - | - | - | - | 6 | 1 | 3.33 | 19.35 | 6 | 3.28 | 21.5 | 42.6 | 13.8 | 20 | 60 |[20250101_134122](./out/official/20250101_134122/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | 5 | 0.1 | 1e-5 | - | - | - | - | 10 | 1 | 3.1 | 26.3 | 10 | 3.12 | 29.8 | 53.1 | 17.8 | 25.8 | 105 |[20250101_164524](/out/official/20250101_164524/) |
| Random crop | No | 32 | WCE | Adam | 1e-4 | 5 | 0.1 | 1e-5 | - | - | - | - | 10 | 1 | 3.1 | 22.9 | 9 | 3.12 | 24.8 | 46.4 | 15.7 | 22.75 | 100 |[20250102_133857](/out/official/20250102_133857) |
| Random crop | No | 32 | CE | Adam | 1e-4 | 5 | 0.1 | 1e-4 | - | - | - | - | 10 | 1 | 3.12 | 26.4 | 10 | 3.12 | 30.2 | 53.7 | 18.1 | 26.2 | 100 |[20250102_133809](/out/official/20250102_133809/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | 5-10 | 0.1 | 1e-5 | - | - | - | - | 20 | 1 | 2.99 | 29 | 10 | 3.02 | 32.6 | 56.3 | 20.6 | 28.9 | 200 |[20250102_154505](/out/official/20250102_154505) |
| Random crop | No | 32 | CE | Adam | 1e-4 | 5 (single) | 0.1 | 1e-4 | - | - | - | - | 20 | 1 | 2.98 | 29.7 | 10 | 2.99 | 33.1 | 56.7 | 21.3 | 29.8 | 200 |[20250102_154917](/out/official/20250102_154917) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | 0.2 | 0.2 | 0.2 | 0.5 | 6 | 1 | 3.45 | 20.4 | 6 | 3.47 | 23.1 | 46.8 | 13.8 | 21 | 89 |[20250103_164630](/out/official/20250103_164630/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | 0.5 | 0.5 | 0.5 | 0.5 | 10 | 1 | 3.18 | 26.4 | 10 | - | - | - | - | - | - |[20250104_145600](/out/official/20250104_145600/) |
| Random crop | No | 32 | CE | Adam | 1e-4 | - | - | 1e-6 | 0.5 | - | 0.5 | 0.5 | 9 | 1 | 3.2 | 25.4 | 9 | - | - | - | - | - | - |[20250104_172600](/out/official/20250104_172600/) |
| ResNet18 | No | 16 | CE | Adam | 1e-4 | - | - | 1e-5 | - | - | - | - | 2 | 1 | 4.0 | 10 | 2 | 4 | 14.5 | 33.5 | 5.5 | 9.84 | ~28 |[20241229_182211](/out/official/20241229_182211/) |
| ResNet18 | No | 16 | WCE | Adam | 1e-4 | - | - | 1e-5 | - | - | - | - | 2 | 1 | 3.87 | 10.3 | 2 | 3.9 | 13.3 | 29.7 | 6.08 | 10 | ~29 |[20241230_205642](/out/official/20241230_205642/) |
| ResNet18 | No | 16 | CE | Adam | 1e-4 | - | - | 1e-5 | - | - |- |- |5 |1 | 3.83 | 17.0 | 4 | 4.15 | 20.9 | 42.8 | 11 | 17.3 | 70 |[20250101_161523](/out/official/20250101_161523/) |
| ResNet18 | No | 16 | CE | Adam | 1e-5 | - | - | 1e-5 | - | - |- |- |5 |1 | 4.0 | 8.18 | 5 | 3.99 | 15.2 | 34.1 | 5 | 8.5 | 70 |[20250101_173950](/out/official/20250101_173950/) |
| ResNet18 | No | 16 | CE | Adam | 1e-4 | - | - | 1e-6 | -|- |- |- |6 |1 | 3.43 | 21.76 | 6 | 3.42 | 24.15 | 48.23 | 14.11 | 22 | ~80 |[20250101_164200](/out/official/20250101_164200) |
| ResNet18 | No | 16 | WCE | Adam | 1e-4 | - | - | 1e-5 | -|- |- |- |6 |1 | 3.39 | 19.0 | 6 | 3.42 | 20.19 | 41.63 | 11.81 | 18.35 | ~84 |[20250101_163902](/out/official/20250101_163902) |
| ResNet18 | 81 | 16 | CE | Adam | 1e-4 | - | - | 1e-5 | - | - | - | - | 2 | 1 | 3.94 | 10.4 | 2 | 3.91 | 16.35 | 36.17 | 6 | 10.6 | ~33 |[20241229_184539](/out/official/20241229_184539/) |
| ResNet18 | 81 | 16 | WCE | Adam | 1e-4 | - | - | 1e-5 | - | - | - | - | 2 | 1 | 3.91 | 9.94 | 2 | 3.92 | 12.3 | 29.4 | 5.7 | 10.1 | ~33 |[20241230_210424](/out/official/20241230_210424/) |
| **ResNet18** | 81 | 16 | CE | Adam | 1e-4 | - |- |1e-5 |- |- |- |-| 6 |1 | 4.09 | 17.36 | 5 | 4.13 | 22.57 | 44.32 | 11.86 | 17.92 | ~91 |[20250101_164431](/out/official/20250101_164431) |
| **ResNet18** | 81 | 16 | WCE | Adam | 1e-4 | -|- |1e-5 | -|-| -|- | 6 | 1| 3.53 | 18.4 | 6 | 3.55 | 21.79 | 42.31 | 13.45 | 19.76 | ~100 |[20250101_165930](/out/official/20250101_165930) |
| ResNet18 | No | 16 | CE |  Adam | 1e-4 |- | - | 1e-4 | -|- |- |- | 11 |1 | 5.12 | 26.47 | 8 | 6.27 (c'è un picco prima) | 27.87 | 52.28 | 17.42 | 25.37 | ~75 |[20250103_171252](/out/official/20250103_171252/) |
| **ResNet18** | No | 16 | CE | Adam | 1e-4 | - | - | 1e-4 | -|- |- |- |6 |1 | 3.39 | 22.5 | 6 | 3.38 | 25.75 | 48.25 | 15 | 22.32 | ~85 |[20250101_171032](/out/official/20250101_171032) |
| ResNet18 | No | 16 | WCE |  Adam |1e-4 | -|- |1e-4 | -|-| -|- | 6 | 1| 3.34 | 19.5 | 6 | 3.35 | 20.35 | 42.76 | 13.13 | 19.77 | ~90 |[20250103_023554](/out/official/20250103_023554/) |
| ResNet18 | 81 | 16 | CE | | Adam | 1e-4  |- |1e-4 | -|-| -|- | 6 | 1| 9.05 | 16.52 | 4 | 6.46 | 21.08 | 44.39 | 11.16 | 17.81 | ~100 |[20250103_024746](/out/official/20250103_024746/) |
| ResNet18 | 81 | 16 | WCE |  Adam | 1e-4 |-|- |1e-4 | -|-| -|- | 6 | 1| 3.51 | 18.9 | 6 | 3.50 | 18.75 | 39.91 | 11.89 | 18.37 | ~95 |[20250103_024403](/out/official/20250103_024403/) |
| ResNet18 | 81 | 16 | CE | Adam | 5e-5 | -|- |1e-4 | -|-| -|- | 6 | 1|  |  |  |  |  |  |  |  |  |[20250104_202647](/out/official/20250104_202647/) |
| ResNet18 | 81 | 16 | CE | Adam |  5e-5 | -|- |1e-5 | -|-| -|- | 6 | 1|  |  |  |  |  |  |  |  |  |[20250104_202934](/out/official/20250104_202934/) |
| ResNet18 | No | 16 | CE | Adam | 5e-5 |  -|- |1e-5 | -|-| -|- | 6 | 1|  |  |  |  |  |  |  |  |  |[20250104_204007](/out/official/20250104_204007/) |
| nResNet18 | 81 | 16 | CE | Adamw | 1e-4 | -|- |1e-4 | -|-| -|- | 6 | 1|  |  |  |  |  |  |  |  |  |[link](/out/official/20250106_011712/) |
| nResNet18 | 81 | 16 | CE | Adamw | 1e-4 | -|- |1e-5 | -|-| -|- | 6 | 1|  |  |  |  |  |  |  |  |  |[link](/out/official/20250106_011325/) |
| nResNet18 | 81 | 16 | WCE | AdamW | 1e-4 | -|- |1e-4 | -|-| -|- | 6 | 1|  |  |  |  |  |  |  |  |  |[link](/out/official/20250106_013932/) |
| MobileNetV3-S | No | 24 | |||  | | | | | | | | | | | | | | | | | |[link]() |
| MobileNetV3-S | 81 | 24 | || || | | | | | | | | | | | | | | | | |[link]() |
| EfficientNet-B0 | No | 8 | || || | | | | | | | | | | | | | | | | |[link]() |
| EfficientNet-B0 | 81 | 8 | || ||| | | | | | | | | | | | | | | | | | [link]() |
| RegNetX-400MF | No | 16 | || | | || | | | | | | | | | | | | | | | [link]() |
| RegNetX-400MF | 81 | 16 | | || | || | | | | | | | | | | | | | | |[link]() |
| ShuffleNetV2-X0.5 | No | 24 | || | || | | | | | | | | | | | | | | | |[link]() |
| ShuffleNetV2-X0.5 | 81 | 24 | || | ||| | | | | | | | | | | | | | | | |[link]() |
| MNasNet-X0.5 | No | 16 | | | | || | | || | | | | | | | | | | | |[link]() |
| MNasNet-X0.5 | 81 | 16 | | | || | | | || | | | | | | | | | | | |[link]() |

(\*) Value computed on training set  
(*\*) In the form "probability - (param1, param2, ...)"  
(\***) Global training time

## Dataset 70-15-15

| Backbone Model | HOG | Batch size | Loss | Optimizer |Learning rate | Scheduler step | Scheduler factor | Weight decay | Color jitter (**) | Lighting noise (**) | Gaussian blur (**) | Geometric transform (**) | Epochs | Reduction factor | Best validation loss| Best validation WT5-MCA (%) | Best epochs | Test loss | Top-1 accuracy (%) | Top-5 accuracy (%) | MCA (%) | Top-5 weighted MCA (%) | Training time (mins) (***) | Output folder | Notes |
|:--------------:|:---:|:--:|:----------:|:-----------:|:--:|:-------------:|:------------:|:--:|:------------:|:------:|:----------------:|:--------------:|:--------------:|:---:|:-------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-6 | - | - | - | - | 5 | 1 | 3.30 | 21.86 | 5 | 3.36 | 24.5 | 48.2 | 13.9 | 21.2 | 52 |[20250105_200736](/out/official/20250105_200736/) | **model corrupted** Good trend but accuracy is low, proceed for 5-10 epochs more |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-6 | - | - | - | - | 14 | 1 | 2.8 | 36.17 | 13 | 2.88 | 33.9 | 60 | 24.5 | 34.13 | 145 |[20250107_202021](/out/official/20250107_202021/) | good, proceed up to 20 |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-6 | - | - | - | - | 14->20 | 1 | 2.72 | 39.36 | 20 | 2.777 | 38.29 | 63.8 | 27.86 | 38 | 210 |[20250107_231054](/out/official/20250107_231054/) | good, proceed up to 20 |
| Random crop | No | 32 | CE | AdamW | 1e-3 | - | - | 1e-5 | - | - | - | - | 5 | 1 | 3.86 | 12.46 | 5 | 3.88 | 16.4 | 35.6 | 7.24 | 12.4 | 53 |[20250105_214543](/out/official/20250105_214543/) | **model corrupted** LR too high (?), accuracy is too low |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 5 | 1 | 3.33 | 23.5 | 5 | 3.38 | 24.5 | 48.1 | 15.1 | 22.5 | 52 |[20250105_214716](/out/official/20250105_214716/) | **model corrupted** Next line has the 5 next epochs | 
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 10 | 1 | 2.935 | 31.2 | 10 | 2.98 | 31.6 | 56.3 | 20.7 | 29.7 | 104 |[20250105_234725](/out/official/20250105_234725/) | **model corrupted** Discrete trend, proceed up to 20 |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 8 | 1 | 3.11 | 28.24 | 8 | 3.14 | 29 | 53.3 | 19.4 | 27.86 | 83 |[20250106_195537](/out/official/20250106_195537/) | Next part in next line |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 8->14 | 1 | 2.756 | 36.87 | 14 | 2.784 | 35.8 | 61.45 | 26.34 | 35.96 | 145 |[20250106_221043](/out/official/20250106_221043/) | Proceed up to 20 epochs |
| Random crop | No | 32 | CE | AdamW | 1e-2 | - | - | 1e-5 | - | - | - | - | 5 | 1 | 3.5 | 21.49 | 5 | 3.52 | 23.59 | 45.37 | 14.2 | 21.03 | 52 |[20250106_115128](/out/official/20250106_115128/) | **model corrupted** LR too high, accuracy has bad trend from 3-4 |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 10 | 1 | 2.93 | 30.7 | 10 | 2.967 | 32.3 | 57.7 | 22.25 | 31.3 | 101 |[20250106_115446](/out/official/20250106_115446/) | **model corrupted** Good trend, proceed up to 20 |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 14 | 1 | 2.76 | 36.75 | 14 | 2.766 | 37.2 | 61.86 | 27.7 | 36.57 | 140 |[20250107_161635](/out/official/20250107_161635/) | Good trend, proceed up to 20 |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6 | 1 | 3.489 | 21.35 | 6 | 3.51 | 24.3 | 46.2 | 14.9 | 21.65 | 114 |[20250106_011712](/out/official/20250106_011712/) | Strange validation trend, proceed some epochs **without HOG** with the same setting |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6->11 | 1 | 2,94 | 3.00 | 11 | 3.04 | 31.10 | 55.16 | 20.81 | 28.9  | ~90  |[20250107_220145](/out/official/20250107_220145/) |   |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 6 | 1 | 3.284 | 24.69 | 6 | 3.29 | 25.22 | 49.64 | 16.26 | 24.3 | 109 |[20250106_011325](/out/official/20250106_011325/) | Good trend for now, proceed as much as possible **without HOG** with the same setting |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 6->11 | 1 | 3.40  |  21 | 2 (sarebbe 8)| 3.43 | 22.6 | 46-40 | 13.99 | 21.25 | 90 |[20250107_220308](/out/official/20250106_220308/) | attenzione alla quarta epoca, val loss a 21 |
| ResNet18 | 81 | 16 | WCE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6 | 1 | 3.324 | 19.25 | 6 | 3.36 | 22.05 | 44.67 | 12.1 | 19.1 | 114 |[20250106_013932](/out/official/20250106_013932/) | Suspend for now, use CE loss |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 6 | 1 | 3.29 | 23.88 | 6 | 3.31 |25.47 | 49.51 | 15.73 | 23.19 | ~95 |[20250106_193020](/out/official/20250106_193020/) | Good trend, other 5-10 epochs  |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 6->15 | 1 | 2.95  | 32.33 | 4 (sarebbe 10) | 3.00 | 31.82 | 56.39 | 21.74 | 31.03 | ~150 |[20250107_135447](/out/official/20250107_135447/) | validation losses ad epoca 6 e 7 (12-13) enorme |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6 | 1 | 3.31 | 23.82 | 6 | 3.32 | 26.42 | 49.29 | 16.38 | 23.91 | ~93 |[20250106_193051](/out/official/20250106_193051/) | Strange step but good, other 5-10 epochs  |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6->11 | 1 | 3.11 | 30.7 | 10  | 3.09 |  29.81 |  55.41| 21.03 | 30.29 | ~75  |[20250107_130610](/out/official/20250107_130610/) | anche qui val losses ha fatto qualche picco: bent num_epocs è 4 che corrisponde alla 10 e non alla 11 |
| ResNet18 | No | 16 | CE | AdamW | 1e-3 | - | - | 1e-5 | - | - | - | - | 6 | 1 | 2.4 | 6.17 | 1 | 6.16  | 3.23| 12.85  | 1.13 | 2.45 | ~90 |[20250106_195019](/out/official/20250106_195019/) | Discard, LR too high  |


## Dataset 70-15-15 and new labeling making

| Backbone Model | HOG | Batch size | Loss | Optimizer |Learning rate | Scheduler milestones | Scheduler factor | Weight decay | Color jitter (**) | Lighting noise (**) | Gaussian blur (**) | Geometric transform (**) | Epochs | Reduction factor | Best validation loss| Best validation WT5-MCA (%) | Best epochs | Test loss | Top-1 accuracy (%) | Top-5 accuracy (%) | MCA (%) | Top-5 weighted MCA (%) | Kaggle score | Training time (mins) (***) | GPU (type, GB) | Output folder | Notes |
|:--------------:|:---:|:--:|:----------:|:-----------:|:--:|:-------------:|:------------:|:--:|:------------:|:------:|:----------------:|:--------------:|:--------------:|:---:|:-------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 14 | 1 | 2.76 | 36.95 | 14 | 2.81 | 35.69 | 61.48 | 26.91 | 36.45 | - | 163 | T4,15 |[20250110_102848](/out/official/20250110_102848/) | |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 14->30 | 1 | 2.85 | 42.15 | 26 | 2.97 | 40.02 | 63.96 | 31.37 | 40.25 | 0.388 | 163 -> 348 | T4,15 |[20250110_170354](/out/official/20250110_170354/) | 1e-4 better gen |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 14 | 1 | 2.76 | 35.57 | 13 | 2.79 | 35.63 | 61.42 | 25.21 | 34.93 | - | 160 | T4,15 |[20250110_102624](/out/official/20250110_102624/) | |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 14->30 | 1 | 2.77 | 42.14 | 26 | 2.83 | 40.15 | 65.19 | 30.98 | 40.41 | 0.393 | 160 -> 345 | T4,15 |[20250110_170152](/out/official/20250110_170152/) |  |
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.72 | 42.33 | 26 | 2.789 | 40.18 | 65.97 | 31.18 | 41.19 | 0.385 | 230 | L4,22 |[20250111_230032](/out/official/20250111_230032/) |  |
| Random crop | No | 48 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 20 | 1 | 2.90 | 37.96 | 20 | 2.97 | 34.06 | 59.97 | 25.91 | 36 | 0.343 | 150 | L4,22 |[20250111_173012](/out/official/20250111_173012/) |  |
| Random crop | No | 48 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 20->30 | 1 | 2.85 | 41.57 | 28 | 2.866 | 39.43 | 63.78 | 31.86 | 41.19 | 0.382 | 150 -> 225 | L4,22 |[20250111_190507](/out/official/20250111_190507/) |  |
| Random crop | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 10 | 1 | 3.05 | 30.31 | 10 | 3.08 | 30.7 | 55.86 | 21.42 | 29.86 | - | 170 | T4,15 |[20250111_181602](/out/official/20250111_181602/) |  |
| Random crop | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 10->20 | 1 | 2.73 | 39.88 | 19 | 2.83 | 37.23 | 62.05 | 29.37 | 38.27 | 0.368 | 170 -> 330 | T4,15 |[20250111_210917](/out/official/20250111_210917/) |  |
| Random crop | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 20->30 | 1 | 2.748 | 43.46 | 27 | 2.786 | 40.94 | 66.87 | 32.93 | 43 | 0.397 | 330->500 | T4,15 |[20250112_125524](/out/official/20250112_125524/) |  |
| Random crop | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 1 | 1 | 0.5 | 1 | 30 | 1 | 2.878 | 42.63 | 29 | 3.02 | 38.3 | 64.3 | 20.6 | 40.6 | - | 290 | L4,22 |[20250114_144509](/out/official/20250114_144509/) |  |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-5 | - | - | - | - | 10 | 1 | 3.08 | 28.4 | 8 | 3.10 | 29.12 | 54.09 | 19.5 | 28.37 | - | ~205 | T4,15 |[20250110_170241](/out/official/20250110_170241) | accuracy crolla a 9, wd 1e-4 meglio |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 10 | 1 | 3.08 | 30.59 | 10 | 3.07 | 30.4 | 55.54 | 21.0 | 29.6 | - | ~205 | T4,15 |[20250110_171222](/out/official/20250110_171222/) |  |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6->12 | 1 | 2.87 | 33.92 | 11 | 2.89 | 33.05  | 58.74 | 23.01 | 32.61 | - | 117 | T4,15 |[20250111_150430](/out/official/20250111_150430) |  |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 12->20 | 1 | 2.72 | 40.45 | 20 | 2.83 | 37.63 | 63.05 | 29.35 | 38.96 | 0.364 | 163 | T4,15 |[20250111_192017](/out/official/20250111_192017) | **WOW** |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | 8 | 0.31622 | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 15 | 1 | 2.71 | 37.26 | 14 | 2.78 | 36.82 | 62.08 | 26.77 | 36.11 | - | 138 | L4,22 |[20250112_173755](/out/official/20250112_173755) | avoid spike in valid |
| ResNet18 | No | 16 | CE | AdamW | 3.612E-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 15->30 | 1 | 2.69 | 41.34 | 27 | 2.745 | 38.64 | 65.25 | 29.85 | 40.25 | - | 138->275 | L4,22 |[20250112_200527](/out/official/20250112_200527/) |  |
| ResNet18 | No | 16 | CE | AdamW | 3.612E-5 | 25 | 0.31622 | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 24->32 | 1 | 2.61 | 42.17 | 30 | 2.64 | 40.6 | 66.5 | 31.4 | 41,7 | - | 166 | T4, 15 |[20250113_204042](/out/official/20250113_204042/) | **ABORT** |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6 | 1 | 3.33 | 23.66 | 5 | 3.37 | 23.75 | 47.91 | 14.91 | 22.43  | - | 130 | T4,15 |[20250111_153540](/out/official/20250111_153540) |  |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 6->12 | 1 | 2.86 | 34.8 | 12 | 2.91 | 33.64 | 58.84 | 25.72 | 34.57 | - | 135 | T4,15 |[20250111_184830](/out/official/20250111_184830) | Start from 12 and decrease |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | - | - | - | - | 12->20 | 1 | 2.87 | 35.38 | 13 | 30.72 | 34.49 | 59.06 | 25.28 | 34.7 | - | 180 | T4,15 |[20250111_223109](/out/official/20250111_223109/) |  not so good, half lr |
| ResNet18 | 81 | 16 | CE | AdamW | 5e-5 | - | - | 1e-4 | - | - | - | - | 12->20 | 1 | 2.65 | 42.17 | 20 | 2.68 | 40.68 | 64.59 | 31.19 | 40.79 | - | 180 | T4,15 |[20250122_153344](/out/official/20250112_153344/) |  good, apply aug |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 10 | 1 | 3.07 | 30.3 | 10 | 3.11 | 29.59 | 54.1 | 20.32 | 29.03 | - | 105 | L4,22 |[20250113_123550](/out/official/20250113_123550/) |  |
| ResNet18 | 81 | 16 | CE | AdamW | 5e-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 10->20 | 1 | 2.64 | 40.33 | 20 | 2.71 | 38.49 | 63.56 | 29.4 | 38.98 | - | 105->210 | L4,22 |[20250113_145143](/out/official/20250113_145143/) |  |
| ResNet18 | 81 | 16 | CE | AdamW | 5e-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 20->30 | 1 | 2.82 | 41.52 | 30 | 2.84 | 39.93 | 65.16 | 30.69 | 40.58 | - | 210->315 | L4,22 |[20250113_164702](/out/official/20250113_164702/) |  |
| ResNet18 | 81 | 16 | CE | AdamW | 2.5e-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 20->30 | 1 | 2.64 | 42.6 | 28 | 2.73 | 40.1 | 65.5 |31.25 | 40.98 | - | 210->315 | L4,22 |[20250113_192428](/out/official/20250113_192428/) |  |
| ResNet18 | 81 | 16 | CE | AdamW | 1.25e-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 28->40 | 1 | 2.69 | 43 | 30 | 2.76 | 40.55 | 65.9 |30.83 | 40.83 | - | 290->420 | L4,22 |[20250113_213506](/out/official/20250113_213506/) |  |
| RegNet X-400MF | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 4 | 1 | 3.56 | 18.4 | 4 | 3.59 | 22.65 | 43.57 | 12.9 | 19.1 | - | 83 | T4,15 |[20250112_135158](/out/official/20250112_135158/) |  apply aug |
| RegNet X-400MF | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 4 | 1 | 3.6 | 17 | 4 | 3.625 | 19.79 | 43.04 | 10.02 | 16.56 | - | 85 | T4,15 |[20250112_152713](/out/official/20250112_152713/) |   |
| RegNet X-400MF | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 4->10 | 1 | 3.127 | 28.48 | 10 | 3.162 | 27.52 | 52.91 | 17.66 | 25.9 | - | 85->210 | T4,15 |[20250112_181016](/out/official/20250112_181016/) |   |
| RegNet X-400MF | No | 16 | CE | AdamW | 5e-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 10->20 | 1 | 2.6 | 39.93 | 19 | 2.6 | 39.18 | 65.4 | 29.45 | 39.65 | - | 210->330 | L4,22 |[20250114_185257](/out/official/20250114_185257/) |   |
| RegNet X-400MF | No | 16 | CE | AdamW | 5e-5 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 20->30 | 1 | 2.5 | 44.2 | 30 | 2.54 | 42.16 | 67.67 | 32.68 | 42.8 | - | 330->555 | T4,15 |[20250114_232417](/out/official/20250114_232417/) |   |
| MobileNetV3-S | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 |  | 1 |  |  |  | 3.162 | 27.52 | 52.91 | 17.66 | 25.9 | - | 130 | T4,15 |[]() | **to update**  |


# Final results


| Backbone Model | HOG | Batch size | Loss | Optimizer |Learning rate | Scheduler milestones | Scheduler factor | Weight decay | Color jitter (**) | Lighting noise (**) | Gaussian blur (**) | Geometric transform (**) | Epochs | Reduction factor | Best validation loss| Best validation WT5-MCA (%) | Best epochs | Test loss | Top-1 accuracy (%) | Top-5 accuracy (%) | MCA (%) | Top-5 weighted MCA (%) | Kaggle score | Training time (mins) (***) | GPU (type, GB) | Output folder | Notes |
|:--------------:|:---:|:--:|:----------:|:-----------:|:--:|:-------------:|:------------:|:--:|:------------:|:------:|:----------------:|:--------------:|:--------------:|:---:|:-------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Random crop | No | 32 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.72 | 42.33 | 26 | 2.789 | 40.18 | 65.97 | 31.18 | 41.19 | 0.385 | 230 | L4,22 |[20250111_230032](/out/official/20250111_230032/) |  |
| Random crop | No | 48 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.85 | 41.57 | 28 | 2.866 | 39.43 | 63.78 | 31.86 | 41.19 | 0.382 | 225 | L4,22 |[20250111_190507](/out/official/20250111_190507/) |  |
| Random crop | No | 16 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.748 | 43.46 | 27 | 2.786 | 40.94 | 66.87 | 32.93 | 43 | 0.397 | 500 | T4,15 |[20250112_125524](/out/official/20250112_125524/) |  |
| ResNet18 | No | 16 | CE | AdamW | 1e-4 | 8 | 0.31622 | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.69 | 41.34 | 27 | 2.745 | 38.64 | 65.25 | 29.85 | 40.25 | - | 275 | L4,22 |[20250112_200527](/out/official/20250112_200527/) |  |
| ResNet18 | 81 | 16 | CE | AdamW | 1e-4 | 10,20 | 0.5 | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.64 | 42.6 | 28 | 2.73 | 40.1 | 65.5 |31.25 | 40.98 | - | 315 | L4,22 |[20250113_192428](/out/official/20250113_192428/) |  |
| MobileNetV3-S | No |  | CE | AdamW | 1e-4 | - | - | 1e-4  | 0.5 | 0.5 | 0.5 | 0.5 | 10 | 1 | 2.94 | 30.37 | 9 | 3.00 | 30.69 | 56.29 | 20.64 | 29.16 | - | 173 | T4,15 |[20250114_203659](/out/official/20250114_203659/) |  |


# Final results with reproducibility setting


| Seed | Backbone Model | HOG | Batch size | Loss | Optimizer |Learning rate | Scheduler milestones | Scheduler factor | Weight decay | Color jitter (**) | Lighting noise (**) | Gaussian blur (**) | Geometric transform (**) | Epochs | Reduction factor | Best validation loss| Best validation WT5-MCA (%) | Best epochs | Test loss | Top-1 accuracy (%) | Top-5 accuracy (%) | MCA (%) | Top-5 weighted MCA (%) | Kaggle score | Training time (mins) (***) | GPU (type, GB) | Output folder | Notes |
|:--:|:--------------:|:---:|:--:|:----------:|:-----------:|:--:|:-------------:|:------------:|:--:|:------------:|:------:|:----------------:|:--------------:|:--------------:|:---:|:-------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| 42 | Random crop | No | 48 | CE | AdamW | 1e-4 | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 | 2.832 | 40.82 | 27 | 2.874 | 38.20 | 62.99 | 30.28 | 39.82 | 0.374 | 244 | L4,22 |[rnd_BS48](/out/official/20250115_141403/) |  |
| 42 | Random crop | No | 32 | CE | AdamW |  | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 |  |  |  | |  |  |  |  |  |  | L4,22 |[rnd_BS32](/out/official//) |  |
| 42 | Random crop | No | 16 | CE | AdamW |  | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 |  |  |  | |  |  |  |  |  |  | L4,22 |[rnd_BS16](/out/official//) |  |
| 42 | ResNet18 | No | 16 | CE | AdamW |  | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 |  |  |  | |  |  |  |  |  |  | L4,22 |[resnet](/out/official//) |  |
| 42 | ResNet18 | No | 16 | CE | AdamW |  | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 |  |  |  | |  |  |  |  |  |  | L4,22 |[resnet_HOG](/out/official//) |  |
| 42 | MobileNetV3-S | No | 16 | CE | AdamW |  | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 |  |  |  | |  |  |  |  |  |  | L4,22 |[mobilenet](/out/official//) |  |
| 42 | RegNetX-400MF | No | 16 | CE | AdamW |  | - | - | 1e-4 | 0.5 | 0.5 | 0.5 | 0.5 | 30 | 1 |  |  |  | |  |  |  |  |  |  | L4,22 |[regnet](/out/official//) |  |
